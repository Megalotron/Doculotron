"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[482],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),l=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=l(n),f=a,m=u["".concat(c,".").concat(f)]||u[f]||d[f]||o;return n?r.createElement(m,i(i({ref:t},p),{},{components:n})):r.createElement(m,i({ref:t},p))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=u;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var l=2;l<o;l++)i[l]=n[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},6385:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var r=n(7462),a=(n(7294),n(3905));const o={sidebar_position:3},i="PCAP streaming",s={unversionedId:"sniffer/streaming",id:"sniffer/streaming",title:"PCAP streaming",description:"The PCAP format is a file format used to store network traffic, it is used by many tools to store network traffic and to replay it.",source:"@site/docs/sniffer/streaming.md",sourceDirName:"sniffer",slug:"/sniffer/streaming",permalink:"/Doculotron/docs/sniffer/streaming",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/sniffer/streaming.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"CLI",permalink:"/Doculotron/docs/sniffer/cli"},next:{title:"GoFlowMeter",permalink:"/Doculotron/docs/category/goflowmeter"}},c={},l=[{value:"Packet record",id:"packet-record",level:2},{value:"The GRPC protocol",id:"the-grpc-protocol",level:2}],p={toc:l};function d(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"pcap-streaming"},"PCAP streaming"),(0,a.kt)("p",null,"The PCAP format is a file format used to store network traffic, it is used by many tools to store network traffic and to replay it."),(0,a.kt)("p",null,"It is a binary file format, it is composed of a header and a list of packets."),(0,a.kt)("h2",{id:"packet-record"},"Packet record"),(0,a.kt)("p",null,"A Packet Record is the standard container for storing the packets coming from the network."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n 0 |                      Timestamp (Seconds)                      |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n 4 |            Timestamp (Microseconds or nanoseconds)            |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n 8 |                    Captured Packet Length                     |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n12 |                    Original Packet Length                     |\n   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n16 /                                                               /\n   /                          Packet Data                          /\n   /                        variable length                        /\n   /                                                               /\n   +---------------------------------------------------------------+\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"The meaning of the fields in the Packet Record is:")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Timestamp (Seconds)")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"Timestamp (Microseconds or nanoseconds)"),":\nseconds and fraction of a seconds values of a timestamp."),(0,a.kt)("p",null,"The seconds value is a 32-bit unsigned integer that represents the number of seconds that have elapsed since 1970-01-01 00:00:00 UTC, and the microseconds or nanoseconds value represents the number of microseconds or nanoseconds that have elapsed since that seconds."),(0,a.kt)("p",null,"Whether the value represents microseconds or nanoseconds is specified by the magic number in the File Header."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Captured Packet Length")," (32 bits):\nan unsigned value that indicates the number of octets captured from the packet (i.e. the length of the Packet Data field). It will be the minimum value among the Original Packet Length and the snapshot length for the interface."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Original Packet Length")," (32 bits):\nan unsigned value that indicates the actual length of the packet when it was transmitted on the network. It can be different from the Captured Packet Length if the packet has been truncated by the capture process."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Packet Data"),":\nthe data coming from the network, including link-layer headers. The actual length of this field is Captured Packet Length. The format of the link-layer headers depends on the LinkType field specified in the file header."),(0,a.kt)("h2",{id:"the-grpc-protocol"},"The GRPC protocol"),(0,a.kt)("p",null,"The sniffer uses the gRPC protocol to send the packets to go-flowmeter.\nThe following protobuf definition is used to send the packets:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-proto"},"message PacketHeader {\n    uint32 ts_sec = 1;\n    uint32 ts_usec = 2;\n    uint32 caplen = 3;\n    uint32 len = 4;\n}\n\nmessage PacketData {\n    bytes data = 1;\n}\n\nmessage Packet {\n    PacketHeader header = 1;\n    PacketData data = 2;\n}\n")),(0,a.kt)("p",null,"The following method is used to start the stream:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-proto"},"service PacketStreaming {\n    rpc Run(stream Packet) returns (google.protobuf.Empty);\n}\n")))}d.isMDXComponent=!0}}]);